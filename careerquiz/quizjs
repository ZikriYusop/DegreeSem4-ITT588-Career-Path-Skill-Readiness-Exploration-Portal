const questions = document.querySelectorAll(".question");
const progressBar = document.getElementById("progressBar");
const nextBtn = document.getElementById("nextBtn");
const quizForm = document.getElementById("quizForm");
const resultSection = document.getElementById("result-section");
const resultDisplay = document.getElementById("result-display");

let current = 0;
const scores = {
    tech: 0,
    people: 0,
    creative: 0,
    business: 0
};

// Career Data
const careerMap = {
    tech: "Technology / IT",
    people: "Education / Healthcare / HR",
    creative: "Creative Industry",
    business: "Business / Management"
};

const careerDescription = {
    tech: "Careers focused on problem-solving, technology, and analytical thinking. You excel in environments that require logical thinking and technical expertise.",
    people: "Careers involving communication, helping others, and teamwork. You thrive in roles where you can support and collaborate with people.",
    creative: "Careers that emphasize creativity, design, and innovation. You shine in fields that allow artistic expression and original thinking.",
    business: "Careers related to management, leadership, and organization. You are suited for roles that require strategic planning and decision-making."
};

const careerSkills = {
    tech: ["Problem-solving", "Logical thinking", "Technical skills", "Analytical abilities", "Attention to detail"],
    people: ["Communication", "Empathy", "Teamwork", "Patience", "Interpersonal skills"],
    creative: ["Creativity", "Design thinking", "Innovation", "Visual thinking", "Adaptability"],
    business: ["Leadership", "Planning", "Decision-making", "Strategic thinking", "Organization"]
};

// Event Listener for Radio Buttons
document.addEventListener("change", (e) => {
    if (e.target.type === "radio") {
        nextBtn.disabled = false;
    }
});

// Show Question Function
function showQuestion(index) {
    // Hide all questions
    questions.forEach(q => q.classList.remove("active"));
    
    // Show current question
    questions[index].classList.add("active");
    
    // Update progress bar
    const progressPercentage = ((index + 1) / questions.length) * 100;
    progressBar.style.width = `${progressPercentage}%`;
    
    // Update button text if last question
    if (index === questions.length - 1) {
        nextBtn.textContent = "See Results";
    } else {
        nextBtn.textContent = "Next";
    }
    
    // Check if current question has an answer
    const isChecked = questions[index].querySelector('input[type="radio"]:checked');
    nextBtn.disabled = !isChecked;
    
    // Update current index
    current = index;
}

// Next Question Function
function nextQuestion() {
    if (current < questions.length - 1) {
        current++;
        showQuestion(current);
    } else {
        calculateResult();
    }
}

// Previous Question Function
function prevQuestion() {
    if (current > 0) {
        current--;
        showQuestion(current);
    }
}

// Calculate Result Function
function calculateResult() {
    // Get all checked answers
    const checkedAnswers = document.querySelectorAll("input[type=radio]:checked");
    
    // Reset scores
    Object.keys(scores).forEach(key => scores[key] = 0);
    
    // Calculate scores
    checkedAnswers.forEach(ans => {
        if (ans.value in scores) {
            scores[ans.value]++;
        }
    });
    
    // Find best match
    let best = "";
    let max = 0;
    let ties = [];
    
    for (let key in scores) {
        if (scores[key] > max) {
            max = scores[key];
            best = key;
            ties = [key];
        } else if (scores[key] === max) {
            ties.push(key);
        }
    }
    
    // Handle ties
    if (ties.length > 1) {
        best = ties[0]; // Simple tie-breaker
    }
    
    // Show Results
    quizForm.classList.add("hidden");
    resultSection.style.display = "block";
    
    // Display Results
    resultDisplay.textContent = `Recommended Career Path: ${careerMap[best]}`;
    document.getElementById("print-career").textContent = careerMap[best];
    document.getElementById("career-description").textContent = careerDescription[best];
    
    // Display Skills
    const skillList = document.getElementById("skill-list");
    skillList.innerHTML = "";
    careerSkills[best].forEach(skill => {
        const li = document.createElement("li");
        li.textContent = skill;
        skillList.appendChild(li);
    });
    
    // Scroll to top of results
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Feedback Function
function submitFeedback() {
    const feedbackText = document.getElementById("feedbackText").value;
    if (feedbackText.trim() === "") {
        alert("Please enter your feedback before submitting.");
        return;
    }
    
    alert("Thank you for your feedback!");
    document.getElementById("feedbackText").value = "";
}

// Initialize Quiz
document.addEventListener('DOMContentLoaded', function() {
    showQuestion(0);
    
    // Keyboard Navigation
    document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' && !nextBtn.disabled) {
            nextQuestion();
        } else if (e.key === 'ArrowLeft') {
            prevQuestion();
        }
    });
});
