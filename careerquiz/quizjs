// =========================================
// BAHAGIAN 1: THEME / DARK MODE 
// =========================================
document.addEventListener('DOMContentLoaded', () => {
    
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    const htmlElement = document.documentElement;

    // Load saved theme
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme) {
        htmlElement.setAttribute('data-bs-theme', savedTheme);
        updateIcon(savedTheme);
    }

    // Toggle event
    if (themeToggle) {
        themeToggle.addEventListener('click', () => {
            const currentTheme = htmlElement.getAttribute('data-bs-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            htmlElement.setAttribute('data-bs-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateIcon(newTheme);
        });
    }

    function updateIcon(theme) {
        if (!themeIcon) return;
        if (theme === 'dark') {
            themeIcon.classList.remove('bi-moon-stars-fill');
            themeIcon.classList.add('bi-sun-fill');
        } else {
            themeIcon.classList.remove('bi-sun-fill');
            themeIcon.classList.add('bi-moon-stars-fill');
        }
    }

    // Initialize quiz
    initQuiz();
});

// =========================================
// BAHAGIAN 2: QUIZ LOGIC - 6 QUESTIONS
// =========================================

// DOM Elements
const questions = document.querySelectorAll(".question");
const progressBar = document.getElementById("progressBar");
const progressText = document.getElementById("progressText");
const nextBtn = document.getElementById("nextBtn");
const quizForm = document.getElementById("quizForm");
const resultSection = document.getElementById("result-section");
const resultDisplay = document.getElementById("result-display");

// Quiz State
let currentQuestion = 0;
const totalQuestions = 6;

// Scores Object (Tutorial 9 - Objects)
const scores = {
    tech: 0,
    people: 0,
    creative: 0,
    business: 0
};

// Career Data (Tutorial 9 - Objects and Arrays)
const careerData = {
    tech: {
        title: "Technology & IT Professional",
        description: "You're analytical and logical! Perfect for careers in software development, data analysis, cybersecurity, or IT support.",
        skills: ["Problem Solving", "Logical Thinking", "Technical Skills", "Attention to Detail"]
    },
    people: {
        title: "People & Services Specialist",
        description: "You're empathetic and communicative! Great for teaching, healthcare, counseling, or customer service roles.",
        skills: ["Communication", "Empathy", "Teamwork", "Patience"]
    },
    creative: {
        title: "Creative Arts Professional",
        description: "You're imaginative and artistic! Ideal for graphic design, writing, marketing, or multimedia production.",
        skills: ["Creativity", "Design Sense", "Innovation", "Visual Thinking"]
    },
    business: {
        title: "Business & Management Leader",
        description: "You're organized and strategic! Suited for project management, entrepreneurship, finance, or administration.",
        skills: ["Leadership", "Planning", "Decision Making", "Organization"]
    }
};

// Initialize Quiz Function
function initQuiz() {
    // Show first question
    showQuestion(currentQuestion);
    
    // Add event listeners to radio buttons
    document.querySelectorAll('.form-check-input').forEach(radio => {
        radio.addEventListener('change', function() {
            enableNextButton();
        });
    });
    
    // Add keyboard navigation
    document.addEventListener('keydown', function(event) {
        if (event.key === 'ArrowRight' && !nextBtn.disabled) {
            nextQuestion();
        } else if (event.key === 'ArrowLeft' && currentQuestion > 0) {
            prevQuestion();
        }
    });
}

// Show Question Function
function showQuestion(index) {
    // Hide all questions
    questions.forEach(q => q.classList.remove("active"));
    
    // Show current question
    questions[index].classList.add("active");
    
    // Update progress bar (Tutorial 4 - CSS Properties)
    const progressPercentage = ((index + 1) / totalQuestions) * 100;
    progressBar.style.width = `${progressPercentage}%`;
    
    // Update progress text
    progressText.textContent = `Question ${index + 1} of ${totalQuestions}`;
    
    // Update button text
    if (index === totalQuestions - 1) {
        nextBtn.innerHTML = 'See Results <i class="bi bi-check-circle"></i>';
    } else {
        nextBtn.innerHTML = 'Next <i class="bi bi-arrow-right"></i>';
    }
    
    // Enable/disable buttons
    enableNextButton();
    
    // Update current question index
    currentQuestion = index;
}

// Enable/Disable Next Button
function enableNextButton() {
    const currentQ = document.querySelector('.question.active');
    const hasAnswer = currentQ.querySelector('input[type="radio"]:checked');
    nextBtn.disabled = !hasAnswer;
}

// Next Question Function
function nextQuestion() {
    if (currentQuestion < totalQuestions - 1) {
        currentQuestion++;
        showQuestion(currentQuestion);
    } else {
        calculateResult();
    }
}

// Previous Question Function
function prevQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        showQuestion(currentQuestion);
    }
}

// Calculate Result Function (Tutorial 8 - Conditionals & Loops)
function calculateResult() {
    // Reset scores
    Object.keys(scores).forEach(key => scores[key] = 0);
    
    // Get all checked answers
    const checkedAnswers = document.querySelectorAll("input[type='radio']:checked");
    
    // Calculate scores
    checkedAnswers.forEach(answer => {
        const value = answer.value;
        if (scores[value] !== undefined) {
            scores[value]++;
        }
    });
    
    // Find highest score
    let bestCareer = "tech";
    let highestScore = 0;
    
    // Loop through scores to find highest (Tutorial 7 - For loops)
    for (let career in scores) {
        if (scores[career] > highestScore) {
            highestScore = scores[career];
            bestCareer = career;
        }
    }
    
    // Display results
    displayResults(bestCareer);
}

// Display Results Function (Tutorial 8 - DOM Manipulation)
function displayResults(careerType) {
    // Hide quiz form
    quizForm.style.display = "none";
    
    // Show results section
    resultSection.style.display = "block";
    
    // Get career data
    const career = careerData[careerType];
    
    // Update result display
    resultDisplay.textContent = `Recommended: ${career.title}`;
    document.getElementById("print-career").textContent = career.title;
    document.getElementById("career-description").textContent = career.description;
    
    // Display skills (Tutorial 7 - Arrays)
    const skillList = document.getElementById("skill-list");
    skillList.innerHTML = "";
    
    career.skills.forEach(skill => {
        const li = document.createElement("li");
        li.className = "";
        li.textContent = skill;
        skillList.appendChild(li);
    });
    
    // Scroll to top smoothly
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

// Restart Quiz Function
function restartQuiz() {
    // Reset quiz state
    currentQuestion = 0;
    
    // Clear all radio selections
    document.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.checked = false;
    });
    
    // Hide results, show quiz
    resultSection.style.display = "none";
    quizForm.style.display = "block";
    
    // Reset progress bar
    progressBar.style.width = "17%";
    progressText.textContent = "Question 1 of 6";
    
    // Reset to first question
    showQuestion(0);
}

// Submit Feedback Function (Tutorial 7 - Functions)
function submitFeedback() {
    const feedbackText = document.getElementById("feedbackText").value;
    
    // Check if feedback is empty (Tutorial 8 - Conditionals)
    if (feedbackText.trim() === "") {
        alert("Please enter your feedback before submitting.");
        return;
    }
    
    alert("Thank you for your feedback! We appreciate your input.");
    document.getElementById("feedbackText").value = "";
}

// Print Results Function
function printResults() {
    alert("Tip: Use Ctrl+P to print your results. Navigation buttons won't appear in print.");
    window.print();
}
